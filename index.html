<html>
  <head>
    <title>Hello world</title>
    <style>
      body { margin: 0; }
      canvas { width: 100%; height: 100% }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r71/three.min.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script>
      var ref = require('ref');
      var ffi = require('ffi');
      //var THREE = require('three');

      var libfab = ffi.Library('libfab/libfab', {
        'add_f': ['float', ['float', 'float']],
      });

      document.write("Sum: ", libfab.add_f(1.2, 3.4));
    </script>

    <script id="vertex-shader" type="x-shader/x-vertex">
      uniform float time;
      varying vec2 vUv;
       
      void main() {
        vUv = uv;
        vec3 newPosition = position + normal * vec3(sin(time * 0.2) * 3.0);
        gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
      }
    </script>

    <script id="fragment-shader" type="x-shader/x-fragment">
      uniform float time;
      varying vec2 vUv;

      void main() {
        vec2 position = -1.0 + 2.0 * vUv;

        float red = abs(sin(position.x * position.y + time / 5.0));
        float green = abs(sin(position.x * position.y + time / 4.0));
        float blue = abs(sin(position.x * position.y + time / 3.0 ));
        gl_FragColor = vec4(red, green, blue, 1.0);
      }
    </script>

    <script type="text/javascript">
      $(function() {
        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000 );

        var renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );

        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshLambertMaterial({ color: 0xdfff00 });
        var shaderMaterial = new THREE.ShaderMaterial({
          attributes: {},
          uniforms: {
            time: { type: "f", value: 0 },
            resolution: { type: "v2", value: new THREE.Vector2 },
          },
          vertexShader: $('#vertex-shader').text(),
          fragementShader: $('#fragment-shader').text()
        });

        var cube = new THREE.Mesh(geometry, material);
        scene.add( cube );

        var light = new THREE.PointLight(0xFFFF00);
        light.position.set(10, 0, 10);
        scene.add(light);

        camera.position.z = 5;

        function render() {
          requestAnimationFrame( render );

          cube.rotation.x += 0.05;
          cube.rotation.y += 0.05;

          renderer.render( scene, camera );
        }
        render();
      });
    </script>

  </head>
  <body>
  </body>
</html>

